services:
  - name: todo-backend
    type: web
    runtime: image
    image:
      url: ghcr.io/mikebg95/todo-project/todo-backend:latest
    plan: free
    region: frankfurt
    port: 8082
    envVars:
      - { key: SPRING_PROFILES_ACTIVE, value: dev }
      - { key: SPRING_DATA_MONGODB_URI, sync: false }  # set value in dashboard
    # uncomment when actuator works
    # healthCheckPath: /actuator/health

  - name: todo-frontend
    type: web
    runtime: image
    image:
      url: ghcr.io/mikebg95/todo-project/todo-frontend:latest
    plan: free
    region: frankfurt
    port: 80
    envVars:
      - { key: BACKEND_URL, value: https://todo-backend-w132.onrender.com/ }

    # Option B (alternative): private network; then update nginx template to use http://$BACKEND_HOSTPORT/
    # - key: BACKEND_HOSTPORT
    #   fromService:
    #     name: todo-backend
    #     type: web
    #     property: hostport
    healthCheckPath: /
